---
title: OTFR APT 29
---

- [Overview](#overview)
- [Environment](#environment)
- [Activity](#activity)
- [Contained Data](#contained-data)
- [Links](#links)
- [Data Examples](#data-examples)

| <!-- -->                 | <!-- -->                                                                                                                                                                                |
|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Network Data Source**  | pcaps, Zeek logs                                                                                                                                                                        |
| **Network Data Labeled** | No                                                                                                                                                                                      |
| **Host Data Source**     | Windows events                                                                                                                                                                          |
| **Host Data Labeled**    | No                                                                                                                                                                                      |
|                          |                                                                                                                                                                                         |
| **Overall Setting**      | Enterprise IT                                                                                                                                                                           |
| **OS Types**             | Windows 10<br/>Windows Server 2019<br/>Ubuntu Server                                                                                                                                    |
| **Number of Machines**   | 6 (+2 attackers)                                                                                                                                                                        |
| **Total Runtime**        | n/a                                                                                                                                                                                     |
| **Year of Collection**   | 2020                                                                                                                                                                                    |
| **Attack Categories**    | Execution<br/>Persistence<br/>Privilege Escalation<br/>Defense Evasion<br/>Credential Access<br/>Discovery<br/>Lateral Movement<br/>Collection<br/>Command and Control<br/>Exfiltration |
| **Benign Activity**      | None                                                                                                                                                                                    |
|                          |                                                                                                                                                                                         |
| **Packed Size**          | 126 MB                                                                                                                                                                                  |
| **Unpacked Size**        | 2,03 GB                                                                                                                                                                                 |
| **Download Link**        | [goto](https://github.com/OTRF/Security-Datasets/tree/master/datasets/compound/apt29)                                                                                                   |

***

### Overview

This is a subset of the Security Datasets Collection focusing on replicating activity assigned to the adversary group
APT 29, as described by MITRE ATT&CK.
It mimics the original sequence of attacks, consisting of two "days" of operations, each characterized by certain
attacker behaviors and intentions.
Its entire creation process from environment creation over log collection to attack execution is documented and
explained in a series of three blog posts, which are linked below.

### Environment

The environment is set up similar to that MITRE suggests - a small enterprise network -, but with some slight
modifications.

### Activity

In general, attack steps consist of combination of commands and/or upload and execution of certain malicious files, with
the end goal of mimicking APT 29 behavior.
Refer to the blog post for more details.

### Contained Data

Collected logs consist of Windows events, packet captures and Zeek logs, and are divided into day 1 and day 2.
However, they are not labeled.

### Links

- [Homepage](https://github.com/OTRF/Security-Datasets/tree/master/datasets/compound/apt29)
- [Environment Setup Blog Post](https://medium.com/threat-hunters-forge/mordor-labs-part-1-deploying-att-ck-apt29-evals-environments-via-arm-templates-to-create-1c6c4bc32c9a)
- [Day 1 Blog Post](https://medium.com/threat-hunters-forge/mordor-labs-part-2-executing-att-ck-apt29-evals-emulation-plan-day1-17fae7a81229)
- [Day 2 Blog Post](https://medium.com/threat-hunters-forge/mordor-labs-part-3-executing-att-ck-apt29-evaluations-emulation-plan-day2-417cadc2a337)
- [MITRE APT 29 Info Page](https://attackevals.mitre-engenuity.org/enterprise/apt29/)
- [MITRE Emulation Plan Day 1](https://github.com/mitre-attack/attack-arsenal/tree/master/adversary_emulation/APT29/Emulation_Plan/Day%201)
- [MITRE Emulation Plan Day 2](https://github.com/mitre-attack/attack-arsenal/tree/master/adversary_emulation/APT29/Emulation_Plan/Day%202)

### Data Examples

Snippet of day 1 Windows event logs taken from `apt29/day1/apt29_evals_day1_manual_2020-05-01225525.json`

```json
{"EventTime":"2020-05-01 23:08:26","port":60737,"Message":"Registry object added or deleted:\r\nRuleName: -\r\nEventType: CreateKey\r\nUtcTime: 2020-05-02 03:08:26.457\r\nProcessGuid: {47ab858c-e374-5eac-d803-000000000400}\r\nProcessId: 3852\r\nImage: C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nTargetObject: HKU\\S-1-5-21-1830255721-3727074217-2423397540-1107\\Software\\Microsoft\\SystemCertificates\\Disallowed","SourceModuleName":"eventlog","EventID":12,"tags":["mordorDataset"],"@version":"1","SourceName":"Microsoft-Windows-Sysmon","AccountType":"User","host":"wec.internal.cloudapp.net","Task":12,"ThreadID":4588,"TargetObject":"HKU\\S-1-5-21-1830255721-3727074217-2423397540-1107\\Software\\Microsoft\\SystemCertificates\\Disallowed","EventReceivedTime":"2020-05-01 23:08:32","Domain":"NT AUTHORITY","UtcTime":"2020-05-02 03:08:26.457","Keywords":-9223372036854775808,"RecordNumber":378531,"SourceModuleType":"im_msvistalog","@timestamp":"2020-05-02T03:08:32.631Z","SeverityValue":2,"Version":2,"OpcodeValue":0,"Severity":"INFO","Channel":"Microsoft-Windows-Sysmon/Operational","AccountName":"SYSTEM","ProcessGuid":"{47ab858c-e374-5eac-d803-000000000400}","Image":"C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe","EventType":"INFO","UserID":"S-1-5-18","ProcessId":"3852","Hostname":"SCRANTON.dmevals.local","RuleName":"-","ExecutionProcessID":3484,"ProviderGuid":"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}"}
{"EventTime":"2020-05-01 23:08:26","port":60737,"Message":"The handle to an object was closed.\r\n\r\nSubject :\r\n\tSecurity ID:\t\tS-1-5-21-1830255721-3727074217-2423397540-1107\r\n\tAccount Name:\t\tpbeesly\r\n\tAccount Domain:\t\tDMEVALS\r\n\tLogon ID:\t\t0x372E81\r\n\r\nObject:\r\n\tObject Server:\t\tSecurity\r\n\tHandle ID:\t\t0x14fc\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0xf0c\r\n\tProcess Name:\t\tC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe","Opcode":"Info","EventID":4658,"SourceModuleName":"eventlog","tags":["mordorDataset"],"@version":"1","SourceName":"Microsoft-Windows-Security-Auditing","SubjectLogonId":"0x372e81","host":"wec.internal.cloudapp.net","Task":12801,"ThreadID":6568,"EventReceivedTime":"2020-05-01 23:08:32","ObjectServer":"Security","ProcessName":"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe","HandleId":"0x14fc","Category":"Registry","Keywords":-9214364837600034816,"RecordNumber":79323,"SourceModuleType":"im_msvistalog","@timestamp":"2020-05-02T03:08:32.631Z","SeverityValue":2,"Version":0,"OpcodeValue":0,"SubjectUserSid":"S-1-5-21-1830255721-3727074217-2423397540-1107","Severity":"INFO","Channel":"Security","SubjectUserName":"pbeesly","SubjectDomainName":"DMEVALS","EventType":"AUDIT_SUCCESS","ProcessId":"0xf0c","Hostname":"SCRANTON.dmevals.local","ExecutionProcessID":4,"ProviderGuid":"{54849625-5478-4994-A5BA-3E3B0328C30D}"}
{"EventTime":"2020-05-01 23:08:26","port":60737,"Message":"Registry object added or deleted:\r\nRuleName: -\r\nEventType: CreateKey\r\nUtcTime: 2020-05-02 03:08:26.457\r\nProcessGuid: {47ab858c-e374-5eac-d803-000000000400}\r\nProcessId: 3852\r\nImage: C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe\r\nTargetObject: HKU\\S-1-5-21-1830255721-3727074217-2423397540-1107\\Software\\Microsoft\\SystemCertificates\\Disallowed\\Certificates","SourceModuleName":"eventlog","EventID":12,"tags":["mordorDataset"],"@version":"1","SourceName":"Microsoft-Windows-Sysmon","AccountType":"User","host":"wec.internal.cloudapp.net","Task":12,"ThreadID":4588,"TargetObject":"HKU\\S-1-5-21-1830255721-3727074217-2423397540-1107\\Software\\Microsoft\\SystemCertificates\\Disallowed\\Certificates","EventReceivedTime":"2020-05-01 23:08:32","Domain":"NT AUTHORITY","UtcTime":"2020-05-02 03:08:26.457","Keywords":-9223372036854775808,"RecordNumber":378532,"SourceModuleType":"im_msvistalog","@timestamp":"2020-05-02T03:08:32.632Z","SeverityValue":2,"Version":2,"OpcodeValue":0,"Severity":"INFO","Channel":"Microsoft-Windows-Sysmon/Operational","AccountName":"SYSTEM","ProcessGuid":"{47ab858c-e374-5eac-d803-000000000400}","Image":"C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe","EventType":"INFO","UserID":"S-1-5-18","ProcessId":"3852","Hostname":"SCRANTON.dmevals.local","RuleName":"-","ExecutionProcessID":3484,"ProviderGuid":"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}"}
{"EventTime":"2020-05-01 23:08:31","port":60737,"Message":"Process accessed:\r\nRuleName: -\r\nUtcTime: 2020-05-02 03:08:31.159\r\nSourceProcessGUID: {5aa8ec29-cadb-5eac-2d00-000000000400}\r\nSourceProcessId: 1844\r\nSourceThreadId: 3156\r\nSourceImage: C:\\windows\\system32\\svchost.exe\r\nTargetProcessGUID: {5aa8ec29-cae0-5eac-5500-000000000400}\r\nTargetProcessId: 3520\r\nTargetImage: C:\\windows\\system32\\svchost.exe\r\nGrantedAccess: 0x1000\r\nCallTrace: C:\\windows\\SYSTEM32\\ntdll.dll+9c584|C:\\windows\\System32\\KERNELBASE.dll+2732e|c:\\windows\\system32\\fwbase.dll+3b35|c:\\windows\\system32\\fwbase.dll+3a89|c:\\windows\\system32\\mpssvc.dll+b907|c:\\windows\\system32\\mpssvc.dll+b75b|c:\\windows\\system32\\mpssvc.dll+e1c2|C:\\windows\\System32\\RPCRT4.dll+76953|C:\\windows\\System32\\RPCRT4.dll+da036|C:\\windows\\System32\\RPCRT4.dll+37a4c|C:\\windows\\System32\\RPCRT4.dll+548c8|C:\\windows\\System32\\RPCRT4.dll+2c921|C:\\windows\\System32\\RPCRT4.dll+2c1db|C:\\windows\\System32\\RPCRT4.dll+1a86f|C:\\windows\\System32\\RPCRT4.dll+19d1a|C:\\windows\\System32\\RPCRT4.dll+19301|C:\\windows\\System32\\RPCRT4.dll+18d6e|C:\\windows\\System32\\RPCRT4.dll+169a5|C:\\windows\\SYSTEM32\\ntdll.dll+3346d|C:\\windows\\SYSTEM32\\ntdll.dll+341c2|C:\\windows\\System32\\KERNEL32.DLL+17bd4|C:\\windows\\SYSTEM32\\ntdll.dll+6ced1","SourceThreadId":"3156","EventID":10,"TargetProcessId":"3520","SourceModuleName":"eventlog","tags":["mordorDataset"],"@version":"1","SourceImage":"C:\\windows\\system32\\svchost.exe","SourceName":"Microsoft-Windows-Sysmon","AccountType":"User","TargetImage":"C:\\windows\\system32\\svchost.exe","host":"wec.internal.cloudapp.net","Task":10,"ThreadID":4224,"EventReceivedTime":"2020-05-01 23:08:32","CallTrace":"C:\\windows\\SYSTEM32\\ntdll.dll+9c584|C:\\windows\\System32\\KERNELBASE.dll+2732e|c:\\windows\\system32\\fwbase.dll+3b35|c:\\windows\\system32\\fwbase.dll+3a89|c:\\windows\\system32\\mpssvc.dll+b907|c:\\windows\\system32\\mpssvc.dll+b75b|c:\\windows\\system32\\mpssvc.dll+e1c2|C:\\windows\\System32\\RPCRT4.dll+76953|C:\\windows\\System32\\RPCRT4.dll+da036|C:\\windows\\System32\\RPCRT4.dll+37a4c|C:\\windows\\System32\\RPCRT4.dll+548c8|C:\\windows\\System32\\RPCRT4.dll+2c921|C:\\windows\\System32\\RPCRT4.dll+2c1db|C:\\windows\\System32\\RPCRT4.dll+1a86f|C:\\windows\\System32\\RPCRT4.dll+19d1a|C:\\windows\\System32\\RPCRT4.dll+19301|C:\\windows\\System32\\RPCRT4.dll+18d6e|C:\\windows\\System32\\RPCRT4.dll+169a5|C:\\windows\\SYSTEM32\\ntdll.dll+3346d|C:\\windows\\SYSTEM32\\ntdll.dll+341c2|C:\\windows\\System32\\KERNEL32.DLL+17bd4|C:\\windows\\SYSTEM32\\ntdll.dll+6ced1","Domain":"NT AUTHORITY","UtcTime":"2020-05-02 03:08:31.159","Keywords":-9223372036854775808,"RecordNumber":346121,"SourceProcessId":"1844","SourceModuleType":"im_msvistalog","@timestamp":"2020-05-02T03:08:32.632Z","SeverityValue":2,"Version":3,"OpcodeValue":0,"Severity":"INFO","Channel":"Microsoft-Windows-Sysmon/Operational","AccountName":"SYSTEM","GrantedAccess":"0x1000","SourceProcessGUID":"{5aa8ec29-cadb-5eac-2d00-000000000400}","EventType":"INFO","UserID":"S-1-5-18","TargetProcessGUID":"{5aa8ec29-cae0-5eac-5500-000000000400}","ProcessId":"1844","Hostname":"NASHUA.dmevals.local","RuleName":"-","ExecutionProcessID":3428,"ProviderGuid":"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}"}
```

Snippet of day 2 Windows event logs taken from `apt29/day2/apt29_evals_day2_manual_2020-05-02035409.json`

```json
{"Message":"Process accessed:\r\nRuleName: -\r\nUtcTime: 2020-05-02 08:28:17.950\r\nSourceProcessGUID: {8320f18b-2b72-5ead-5e00-000000000500}\r\nSourceProcessId: 836\r\nSourceThreadId: 4208\r\nSourceImage: C:\\windows\\system32\\wbem\\wmiprvse.exe\r\nTargetProcessGUID: {8320f18b-2b6d-5ead-3c00-000000000500}\r\nTargetProcessId: 2576\r\nTargetImage: C:\\windows\\system32\\svchost.exe\r\nGrantedAccess: 0x1400\r\nCallTrace: C:\\windows\\SYSTEM32\\ntdll.dll+9c584|C:\\windows\\System32\\KERNELBASE.dll+2732e|C:\\windows\\system32\\wbem\\cimwin32.dll+11f23d|C:\\windows\\system32\\wbem\\cimwin32.dll+11e86c|C:\\windows\\system32\\wbem\\cimwin32.dll+4882b|C:\\windows\\SYSTEM32\\framedynos.dll+864b|C:\\windows\\system32\\wbem\\wmiprvse.exe+10a32|C:\\windows\\system32\\wbem\\wmiprvse.exe+106bb|C:\\windows\\System32\\RPCRT4.dll+76953|C:\\windows\\System32\\RPCRT4.dll+1364b|C:\\windows\\System32\\combase.dll+a2da2|C:\\windows\\System32\\RPCRT4.dll+59a7b|C:\\windows\\System32\\combase.dll+2f333|C:\\windows\\System32\\combase.dll+2f123|C:\\windows\\System32\\combase.dll+a5936|C:\\windows\\System32\\combase.dll+48a1a|C:\\windows\\System32\\combase.dll+a15ad|C:\\windows\\System32\\combase.dll+5736c|C:\\windows\\System32\\combase.dll+57bd1|C:\\windows\\System32\\combase.dll+59378|C:\\windows\\System32\\RPCRT4.dll+548c8|C:\\windows\\System32\\RPCRT4.dll+2c921|C:\\windows\\System32\\RPCRT4.dll+2c470|C:\\windows\\System32\\RPCRT4.dll+1a6bf","SourceThreadId":"4208","SourceImage":"C:\\windows\\system32\\wbem\\wmiprvse.exe","@version":"1","SourceProcessId":"836","EventType":"INFO","Channel":"Microsoft-Windows-Sysmon/Operational","GrantedAccess":"0x1400","ThreadID":3988,"UserID":"S-1-5-18","RecordNumber":1052807,"SeverityValue":2,"Severity":"INFO","TargetProcessGUID":"{8320f18b-2b6d-5ead-3c00-000000000500}","AccountName":"SYSTEM","tags":["mordorDataset"],"TargetImage":"C:\\windows\\system32\\svchost.exe","host":"wec.internal.cloudapp.net","SourceName":"Microsoft-Windows-Sysmon","UtcTime":"2020-05-02 08:28:17.950","RuleName":"-","SourceModuleName":"eventlog","EventID":10,"EventTime":"2020-05-02 04:28:17","port":64167,"@timestamp":"2020-05-02T08:28:18.690Z","Keywords":-9223372036854775808,"AccountType":"User","Version":3,"Domain":"NT AUTHORITY","CallTrace":"C:\\windows\\SYSTEM32\\ntdll.dll+9c584|C:\\windows\\System32\\KERNELBASE.dll+2732e|C:\\windows\\system32\\wbem\\cimwin32.dll+11f23d|C:\\windows\\system32\\wbem\\cimwin32.dll+11e86c|C:\\windows\\system32\\wbem\\cimwin32.dll+4882b|C:\\windows\\SYSTEM32\\framedynos.dll+864b|C:\\windows\\system32\\wbem\\wmiprvse.exe+10a32|C:\\windows\\system32\\wbem\\wmiprvse.exe+106bb|C:\\windows\\System32\\RPCRT4.dll+76953|C:\\windows\\System32\\RPCRT4.dll+1364b|C:\\windows\\System32\\combase.dll+a2da2|C:\\windows\\System32\\RPCRT4.dll+59a7b|C:\\windows\\System32\\combase.dll+2f333|C:\\windows\\System32\\combase.dll+2f123|C:\\windows\\System32\\combase.dll+a5936|C:\\windows\\System32\\combase.dll+48a1a|C:\\windows\\System32\\combase.dll+a15ad|C:\\windows\\System32\\combase.dll+5736c|C:\\windows\\System32\\combase.dll+57bd1|C:\\windows\\System32\\combase.dll+59378|C:\\windows\\System32\\RPCRT4.dll+548c8|C:\\windows\\System32\\RPCRT4.dll+2c921|C:\\windows\\System32\\RPCRT4.dll+2c470|C:\\windows\\System32\\RPCRT4.dll+1a6bf","EventReceivedTime":"2020-05-02 04:28:18","ProviderGuid":"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}","SourceProcessGUID":"{8320f18b-2b72-5ead-5e00-000000000500}","TargetProcessId":"2576","SourceModuleType":"im_msvistalog","ProcessId":"836","ExecutionProcessID":3172,"Task":10,"Hostname":"UTICA.dmevals.local","OpcodeValue":0}
{"IpAddress":"::1","WorkstationName":"-","SubjectUserSid":"S-1-0-0","LogonGuid":"{2ba297e5-dc7d-4ecc-ae18-902150aef9d9}","ThreadID":3324,"RecordNumber":210355,"tags":["mordorDataset"],"host":"wec.internal.cloudapp.net","SourceName":"Microsoft-Windows-Security-Auditing","LogonProcessName":"Kerberos","IpPort":"63460","RestrictedAdminMode":"-","KeyLength":"0","EventTime":"2020-05-02 04:28:17","port":64167,"@timestamp":"2020-05-02T08:28:18.690Z","Keywords":-9214364837600034816,"TargetLogonId":"0x7e0b50","LogonType":"3","ProviderGuid":"{54849625-5478-4994-A5BA-3E3B0328C30D}","SubjectLogonId":"0x0","ExecutionProcessID":708,"Hostname":"NEWYORK.dmevals.local","Message":"An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Information:\r\n\tLogon Type:\t\t3\r\n\tRestricted Admin Mode:\t-\r\n\tVirtual Account:\t\tNo\r\n\tElevated Token:\t\tYes\r\n\r\nImpersonation Level:\t\tImpersonation\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tNEWYORK$\r\n\tAccount Domain:\t\tDMEVALS.LOCAL\r\n\tLogon ID:\t\t0x7E0B50\r\n\tLinked Logon ID:\t\t0x0\r\n\tNetwork Account Name:\t-\r\n\tNetwork Account Domain:\t-\r\n\tLogon GUID:\t\t{2ba297e5-dc7d-4ecc-ae18-902150aef9d9}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x0\r\n\tProcess Name:\t\t-\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t-\r\n\tSource Network Address:\t::1\r\n\tSource Port:\t\t63460\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tKerberos\r\n\tAuthentication Package:\tKerberos\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.","ImpersonationLevel":"%%1833","@version":"1","AuthenticationPackageName":"Kerberos","EventType":"AUDIT_SUCCESS","Channel":"Security","ProcessName":"-","TransmittedServices":"-","LmPackageName":"-","SeverityValue":2,"Severity":"INFO","SubjectUserName":"-","SubjectDomainName":"-","SourceModuleName":"eventlog","TargetUserSid":"S-1-5-18","EventID":4624,"Category":"Logon","TargetDomainName":"DMEVALS.LOCAL","ProcessId":"0x0","ElevatedToken":"%%1842","SourceModuleType":"im_msvistalog","EventReceivedTime":"2020-05-02 04:28:18","Version":2,"TargetUserName":"NEWYORK$","TargetOutboundUserName":"-","VirtualAccount":"%%1843","TargetOutboundDomainName":"-","Opcode":"Info","Task":12544,"OpcodeValue":0,"TargetLinkedLogonId":"0x0"}
{"Message":"Process accessed:\r\nRuleName: -\r\nUtcTime: 2020-05-02 08:28:17.950\r\nSourceProcessGUID: {8320f18b-2b72-5ead-5e00-000000000500}\r\nSourceProcessId: 836\r\nSourceThreadId: 4208\r\nSourceImage: C:\\windows\\system32\\wbem\\wmiprvse.exe\r\nTargetProcessGUID: {8320f18b-2b6d-5ead-3e00-000000000500}\r\nTargetProcessId: 2624\r\nTargetImage: C:\\windows\\system32\\svchost.exe\r\nGrantedAccess: 0x1400\r\nCallTrace: C:\\windows\\SYSTEM32\\ntdll.dll+9c584|C:\\windows\\System32\\KERNELBASE.dll+2732e|C:\\windows\\system32\\wbem\\cimwin32.dll+11f23d|C:\\windows\\system32\\wbem\\cimwin32.dll+11e86c|C:\\windows\\system32\\wbem\\cimwin32.dll+4882b|C:\\windows\\SYSTEM32\\framedynos.dll+864b|C:\\windows\\system32\\wbem\\wmiprvse.exe+10a32|C:\\windows\\system32\\wbem\\wmiprvse.exe+106bb|C:\\windows\\System32\\RPCRT4.dll+76953|C:\\windows\\System32\\RPCRT4.dll+1364b|C:\\windows\\System32\\combase.dll+a2da2|C:\\windows\\System32\\RPCRT4.dll+59a7b|C:\\windows\\System32\\combase.dll+2f333|C:\\windows\\System32\\combase.dll+2f123|C:\\windows\\System32\\combase.dll+a5936|C:\\windows\\System32\\combase.dll+48a1a|C:\\windows\\System32\\combase.dll+a15ad|C:\\windows\\System32\\combase.dll+5736c|C:\\windows\\System32\\combase.dll+57bd1|C:\\windows\\System32\\combase.dll+59378|C:\\windows\\System32\\RPCRT4.dll+548c8|C:\\windows\\System32\\RPCRT4.dll+2c921|C:\\windows\\System32\\RPCRT4.dll+2c470|C:\\windows\\System32\\RPCRT4.dll+1a6bf","SourceThreadId":"4208","SourceImage":"C:\\windows\\system32\\wbem\\wmiprvse.exe","@version":"1","SourceProcessId":"836","EventType":"INFO","Channel":"Microsoft-Windows-Sysmon/Operational","GrantedAccess":"0x1400","ThreadID":3988,"UserID":"S-1-5-18","RecordNumber":1052808,"SeverityValue":2,"Severity":"INFO","TargetProcessGUID":"{8320f18b-2b6d-5ead-3e00-000000000500}","AccountName":"SYSTEM","tags":["mordorDataset"],"TargetImage":"C:\\windows\\system32\\svchost.exe","host":"wec.internal.cloudapp.net","SourceName":"Microsoft-Windows-Sysmon","UtcTime":"2020-05-02 08:28:17.950","RuleName":"-","SourceModuleName":"eventlog","EventID":10,"EventTime":"2020-05-02 04:28:17","port":64167,"@timestamp":"2020-05-02T08:28:18.690Z","Keywords":-9223372036854775808,"AccountType":"User","Version":3,"Domain":"NT AUTHORITY","CallTrace":"C:\\windows\\SYSTEM32\\ntdll.dll+9c584|C:\\windows\\System32\\KERNELBASE.dll+2732e|C:\\windows\\system32\\wbem\\cimwin32.dll+11f23d|C:\\windows\\system32\\wbem\\cimwin32.dll+11e86c|C:\\windows\\system32\\wbem\\cimwin32.dll+4882b|C:\\windows\\SYSTEM32\\framedynos.dll+864b|C:\\windows\\system32\\wbem\\wmiprvse.exe+10a32|C:\\windows\\system32\\wbem\\wmiprvse.exe+106bb|C:\\windows\\System32\\RPCRT4.dll+76953|C:\\windows\\System32\\RPCRT4.dll+1364b|C:\\windows\\System32\\combase.dll+a2da2|C:\\windows\\System32\\RPCRT4.dll+59a7b|C:\\windows\\System32\\combase.dll+2f333|C:\\windows\\System32\\combase.dll+2f123|C:\\windows\\System32\\combase.dll+a5936|C:\\windows\\System32\\combase.dll+48a1a|C:\\windows\\System32\\combase.dll+a15ad|C:\\windows\\System32\\combase.dll+5736c|C:\\windows\\System32\\combase.dll+57bd1|C:\\windows\\System32\\combase.dll+59378|C:\\windows\\System32\\RPCRT4.dll+548c8|C:\\windows\\System32\\RPCRT4.dll+2c921|C:\\windows\\System32\\RPCRT4.dll+2c470|C:\\windows\\System32\\RPCRT4.dll+1a6bf","EventReceivedTime":"2020-05-02 04:28:18","ProviderGuid":"{5770385F-C22A-43E0-BF4C-06F5698FFBD9}","SourceProcessGUID":"{8320f18b-2b72-5ead-5e00-000000000500}","TargetProcessId":"2624","SourceModuleType":"im_msvistalog","ProcessId":"836","ExecutionProcessID":3172,"Task":10,"Hostname":"UTICA.dmevals.local","OpcodeValue":0}
{"Message":"Group membership information.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-0-0\r\n\tAccount Name:\t\t-\r\n\tAccount Domain:\t\t-\r\n\tLogon ID:\t\t0x0\r\n\r\nLogon Type:\t\t\t3\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tNEWYORK$\r\n\tAccount Domain:\t\tDMEVALS.LOCAL\r\n\tLogon ID:\t\t0x7E0B50\r\n\r\nEvent in sequence:\t\t1 of 1\r\n\r\nGroup Membership:\t\t\t\r\n\t\t%{S-1-5-32-544}\r\n\t\t%{S-1-1-0}\r\n\t\t%{S-1-5-32-554}\r\n\t\t%{S-1-5-32-545}\r\n\t\t%{S-1-5-32-555}\r\n\t\t%{S-1-5-32-560}\r\n\t\t%{S-1-5-2}\r\n\t\t%{S-1-5-11}\r\n\t\t%{S-1-5-15}\r\n\t\t%{S-1-5-21-1719095684-3458891352-3955206944-1000}\r\n\t\t%{S-1-5-21-1719095684-3458891352-3955206944-516}\r\n\t\t%{S-1-5-9}\r\n\t\t%{S-1-18-1}\r\n\t\t%{S-1-5-21-1719095684-3458891352-3955206944-572}\r\n\t\t%{S-1-16-16384}\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThis event is generated when the Audit Group Membership subcategory is configured.  The Logon ID field can be used to correlate this event with the corresponding user logon event as well as to any other security audit events generated during this logon session.","Opcode":"Info","GroupMembership":"\r\n\t\t%{S-1-5-32-544}\r\n\t\t%{S-1-1-0}\r\n\t\t%{S-1-5-32-554}\r\n\t\t%{S-1-5-32-545}\r\n\t\t%{S-1-5-32-555}\r\n\t\t%{S-1-5-32-560}\r\n\t\t%{S-1-5-2}\r\n\t\t%{S-1-5-11}\r\n\t\t%{S-1-5-15}\r\n\t\t%{S-1-5-21-1719095684-3458891352-3955206944-1000}\r\n\t\t%{S-1-5-21-1719095684-3458891352-3955206944-516}\r\n\t\t%{S-1-5-9}\r\n\t\t%{S-1-18-1}\r\n\t\t%{S-1-5-21-1719095684-3458891352-3955206944-572}\r\n\t\t%{S-1-16-16384}","@version":"1","EventIdx":"1","EventCountTotal":"1","SubjectUserSid":"S-1-0-0","EventType":"AUDIT_SUCCESS","Channel":"Security","ThreadID":3324,"RecordNumber":210356,"SeverityValue":2,"Severity":"INFO","SubjectUserName":"-","SubjectDomainName":"-","tags":["mordorDataset"],"host":"wec.internal.cloudapp.net","SourceName":"Microsoft-Windows-Security-Auditing","SourceModuleName":"eventlog","TargetUserSid":"S-1-5-18","EventID":4627,"Category":"Group Membership","EventTime":"2020-05-02 04:28:17","port":64167,"@timestamp":"2020-05-02T08:28:18.691Z","Keywords":-9214364837600034816,"TargetDomainName":"DMEVALS.LOCAL","Version":0,"TargetLogonId":"0x7e0b50","LogonType":"3","EventReceivedTime":"2020-05-02 04:28:18","ProviderGuid":"{54849625-5478-4994-A5BA-3E3B0328C30D}","SubjectLogonId":"0x0","TargetUserName":"NEWYORK$","SourceModuleType":"im_msvistalog","ExecutionProcessID":708,"Task":12554,"Hostname":"NEWYORK.dmevals.local","OpcodeValue":0}
```

Snippet of Zeek logs, taken from `apt29/day2/zeek/combined_zeek.log`

```
{"@stream":"stats","@system":"test-nsm","@proc":"zeek","ts":1588317481.070546,"peer":"zeek","mem":113,"pkts_proc":305,"bytes_recv":82421,"events_proc":508,"events_queued":498,"active_tcp_conns":0,"active_udp_conns":1,"active_icmp_conns":0,"tcp_conns":7,"udp_conns":12,"icmp_conns":0,"timers":339,"active_timers":39,"files":0,"active_files":0,"dns_requests":0,"active_dns_requests":0,"reassem_tcp_size":0,"reassem_file_size":0,"reassem_frag_size":0,"reassem_unknown_size":0}
{"@stream":"stats","@system":"test-nsm","@proc":"zeek","ts":1588317816.467288,"peer":"zeek","mem":113,"pkts_proc":7,"bytes_recv":860,"events_proc":32,"events_queued":37,"active_tcp_conns":0,"active_udp_conns":1,"active_icmp_conns":0,"tcp_conns":0,"udp_conns":3,"icmp_conns":0,"timers":98,"active_timers":37,"files":0,"active_files":0,"dns_requests":0,"active_dns_requests":0,"reassem_tcp_size":0,"reassem_file_size":0,"reassem_frag_size":0,"reassem_unknown_size":0}
{"@stream":"stats","@system":"test-nsm","@proc":"zeek","ts":1588318171.471438,"peer":"zeek","mem":113,"pkts_proc":27,"bytes_recv":7562,"events_proc":67,"events_queued":62,"active_tcp_conns":1,"active_udp_conns":0,"active_icmp_conns":0,"tcp_conns":2,"udp_conns":1,"icmp_conns":0,"timers":106,"active_timers":39,"files":0,"active_files":0,"dns_requests":0,"active_dns_requests":0,"reassem_tcp_size":0,"reassem_file_size":0,"reassem_frag_size":0,"reassem_unknown_size":0}
{"@stream":"weird","@system":"test-nsm","@proc":"zeek","ts":1588316990.488728,"name":"ip_hdr_len_zero","notice":false,"peer":"zeek"}
{"@stream":"weird","@system":"test-nsm","@proc":"zeek","ts":1588317050.66519,"uid":"C6B7f1y1eWtfuTNR6","id_orig_h":"10.0.1.4","id_orig_p":55605,"id_resp_h":"10.0.0.4","id_resp_p":49667,"name":"unknown_dce_rpc_auth_type","addl":"68","notice":false,"peer":"zeek"}
{"@stream":"weird","@system":"test-nsm","@proc":"zeek","ts":1588317890.582266,"name":"ip_hdr_len_zero","notice":false,"peer":"zeek"}
{"@stream":"capture_loss","@system":"test-nsm","@proc":"zeek","ts":1588317394.364058,"ts_delta":872.1779289245605,"peer":"zeek","gaps":29,"acks":1556,"percent_lost":1.8637532133676094}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316522.186129,"uid":"CizEoL2BZYFA8BLZH1","id_orig_h":"10.0.1.5","id_orig_p":60818,"id_resp_h":"10.0.0.4","id_resp_p":445,"proto":"tcp","service":"krb,smb,gssapi","duration":10.780650854110718,"orig_bytes":4000,"resp_bytes":1681,"conn_state":"RSTO","missed_bytes":0,"history":"ShADdaR","orig_pkts":12,"orig_ip_bytes":1307,"resp_pkts":10,"resp_ip_bytes":2093,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316544.441272,"uid":"CKhqWU37Nzb7AMvChi","id_orig_h":"10.0.1.5","id_orig_p":64801,"id_resp_h":"10.0.0.4","id_resp_p":53,"proto":"udp","service":"dns","duration":0.0014269351959228516,"orig_bytes":55,"resp_bytes":71,"conn_state":"SF","missed_bytes":0,"history":"Dd","orig_pkts":1,"orig_ip_bytes":83,"resp_pkts":1,"resp_ip_bytes":99,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316619.741163,"uid":"CWL8Wx2FRSIRuS24f1","id_orig_h":"10.0.1.5","id_orig_p":60839,"id_resp_h":"192.168.0.4","id_resp_p":443,"proto":"tcp","service":"ssl","duration":0.15779900550842285,"orig_bytes":358,"resp_bytes":5980,"conn_state":"SF","missed_bytes":0,"history":"ShADadfF","orig_pkts":9,"orig_ip_bytes":730,"resp_pkts":10,"resp_ip_bytes":6392,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316620.025851,"uid":"Cy292h3bS9xbCR8103","id_orig_h":"10.0.1.5","id_orig_p":60841,"id_resp_h":"192.168.0.4","id_resp_p":443,"proto":"tcp","service":"ssl","duration":0.08468794822692871,"orig_bytes":743,"resp_bytes":34095,"conn_state":"SF","missed_bytes":0,"history":"ShADadfF","orig_pkts":7,"orig_ip_bytes":1035,"resp_pkts":9,"resp_ip_bytes":34467,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316619.793476,"uid":"C1M85n1xRC4xH8LFSe","id_orig_h":"10.0.1.5","id_orig_p":55979,"id_resp_h":"10.0.0.4","id_resp_p":53,"proto":"udp","service":"dns","duration":0.06476283073425293,"orig_bytes":82,"resp_bytes":207,"conn_state":"SF","missed_bytes":0,"history":"Dd","orig_pkts":2,"orig_ip_bytes":138,"resp_pkts":1,"resp_ip_bytes":235,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316625.213525,"uid":"CCC3gZ1noPGS5oSSme","id_orig_h":"10.0.1.5","id_orig_p":60842,"id_resp_h":"192.168.0.4","id_resp_p":443,"proto":"tcp","service":"ssl","duration":0.07885193824768066,"orig_bytes":644,"resp_bytes":91162,"conn_state":"SF","missed_bytes":0,"history":"ShADadfF","orig_pkts":11,"orig_ip_bytes":1096,"resp_pkts":14,"resp_ip_bytes":91734,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
{"@stream":"conn","@system":"test-nsm","@proc":"zeek","ts":1588316626.603225,"uid":"CQVqZ2qrKjm74Ojx2","id_orig_h":"10.0.1.5","id_orig_p":60843,"id_resp_h":"192.168.0.4","id_resp_p":443,"proto":"tcp","service":"ssl","duration":0.04291510581970215,"orig_bytes":2570,"resp_bytes":346,"conn_state":"SF","missed_bytes":0,"history":"ShADadfF","orig_pkts":7,"orig_ip_bytes":1005,"resp_pkts":8,"resp_ip_bytes":678,"orig_l2_addr":"00:0d:3a:9a:33:1a","resp_l2_addr":"12:34:56:78:9a:bc"}
```